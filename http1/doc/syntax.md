# HTTP/1.0のシンタックス

HTTPを構成する要素である

- メソッドとパス
- ヘッダー
- ボディ
- ステータスコード

にフォーカスして解説する

## HTTP/0.9でできることを試す

リクエストを投げてレスポンスを得る

```
curl --http1.0 http://localhost:18888/greeting
```

リクエストにクエリを付与する。

```
curl --http1.0 --get --data-urlencode "search word" http://localhost:18888
```

下のコマンドは`http://localhost:18888/?search+word`というリクエストを投げているのと同じ

## HTTP/0.9から1.0への道のり

HTTP/0.9では

- 一つのドキュメントを送る機能しかなかった
- 通信される全ての内容はHTML文書であるという想定だったため, ダウンロードするコンテンツのフォーマットをサーバーから伝える手段がなかった
- クライアント側から検索のリクエストを送る以外のリクエストを送信できなかった
- 新しい文章を送信したり, 更新したり, 削除することはできなかった
- リクエストが正しかったか, もしくはサーバーが正しく応答することができたかといった情報をしる方法がなかった

HTTP/1.0のリクエストを試す

```
curl -v --http1.0 http://localhost:18888/greeting
```

HTTP/1.0では

- リクエスト時にメソッドが追加された(GET)
- リクエスト時にHTTPバージョンが追加された(HTTP/1.0)
- ヘッダーが追加された(Host, User-Agent, Accept)

といった変更がなされている

## HTTPの先祖(電子メール)

ヘッダーの元々のアイデアはメールシステムから来ている

ヘッダーを送ってみる

```
curl --http1.0 -H "X-Test: Hello" http://localhost:18888
```

ヘッダーは`フィールド名: 値`という形式で本文の前に付加されている

ヘッダーはサーバーとクライアント間で, 追加情報, 指示や命令, お願いなどを書く場所で, 例えば

- クライアント側
  - User-Agent
  - Referer
  - Authorization
- サーバー側
  - Content-Type
  - Content-Length
  - Content-Encoding
  - Date

といったものがある

`X-`から始まるヘッダーは各アプリケーションが自由に使って良いものとされている

同じヘッダーを複数送ることもできる

```
curl --http1.0 -H "X-Test: Hello" -H "X-Test: Ni" http://localhost:18888/greeting
```

ちなみによく使われるヘッダーに関しては, curlはエイリアスを容易してくれている

```
curl -v --http1.0 -A "Mozzila/5.0 (compatible: MSIE 10.0; Windows NT 6.1; Trient/6.0)" http://localhost:18888
```

上記のエイリアスは下記のコマンドと等価である

```
curl -v --http1.0 -H "User-Agent: Mozzila/5.0 (compatible: MSIE 10.0; Windows NT 6.1; Trient/6.0)" http://localhost:18888
```

## HTTPの先祖(ニュースグループ)

HTTPはニュースグループから, メソッドとスタータスコードという２つの機能を導入している

メソッドは下記で構成されている

- GET
  - サーバーに対してヘッダーとコンテンツを要求
- HEAD
  - サーバーに対してヘッダーのみを要求
- POST
  - 新しいドキュメントを投稿
- PUT
  - すでに存在するURLのドキュメントを更新
- DELETE
  - 指定されたURLのドキュメントを削除する

POSTメソッドを送ってみる

```
curl --http1.0 -X POST http://localhost:18888/greeting
```

ステータスコードは下記で構成されている

- 100
  - 処理中の情報の伝達について
- 200
  - 応答の成功時について
- 300
  - サーバーからクライアントへの命令について
- 400
  - クライアントから送られたリクエストにおかしなことがある場合
- 500
  - サーバー内部でエラーが発生した場合について

## リダイレクト

300番台のステータスコードの一部には, サーバーがブラウザに対してリダイレクトするように命令するものがある

- 301/308
  - リクエストされたページが別の場所に移動した時に使う
- 302/307
  - メンテナンスページヘの遷移など一時的に移動したい時に使う
- 303
  - ログインページなどリクエストされたページに返すコンテンツがなかったり本来返すべきページが別にあるときに使う

## ボディ

リクエスト側からボディを送る

```
curl -d "{\"hello\": \"world\"}" -H "Content-Type: application/json" http://localhost:18888
```

ファイルから読み込んだ内容をボディとして送信できる

```
curl -d @test.json -H "Content-Type: application/json" http://localhost:18888
```

ちなみにGETメソッドはボディを無視する(ボティのセマンティクスを定めていない)ことは留意すること
